# Forensics
## Challenge 1
The challenge wants us to find the flag inside a zip file that contents several directories. 

However, a flag.png file was found in the Desktop. I notice the thumbnail was not right so I checked its header via magic bytes. I was right, the file was supposed to be a zip file so I renamed the file to its appopriate file extension.

![image](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/a97c365c-c671-4e0c-83e7-2a1ce8e01281)

After converting, the zip file contains another text file which is the actual flag. But the zip is password protect with the ZipCrypto Store method which is highly vulnerable to plaintext attack similar to a challenge in BOH2023. However, since its only the flag.txt inside the zip and the contents is estimated to be `wgmy{`, the content is not sufficient to perform a plaintext attack.

![image](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/1e47116c-f80b-4d8b-a87e-59e6192e5497)

![image](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/25435db3-23a2-4f9e-a1a3-cb432192b22c)

Hence, I started looking for other ways to obtain the password and came across this RDP file. Googling what an rdp file is, I found out that there is a tool dedicated to parsing the RDP bitmap cache and building it into a full image for secret information.

![image](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/986ee326-4141-4f0b-b3c6-ae31ffd2ad4f)

![image](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/5fb8879d-57a6-4b4d-8ba7-8346c20665b6)

Using `BMC` tool, I can parse the RDP bitmap cache and use them to obtain the zip password. Analyzing the bitmap cache, we can see someone inputting the zip password, so it's time to build!!

![image](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/b0f2a25b-a3b4-470d-9160-9aac3357a715)

After looking at these pieces for 1 hour, I found the password to be `WGMY_P4ssw0rd_N0t_V3ry_H4rd!!!`. So, with the password the flag can be obtained.

![image](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/985799e4-3b3b-4686-a7d0-b23da430863c)

# Scoreboard
## Team HLG

![wargames](https://github.com/warlocksmurf/ctf-writeups/assets/121353711/1b411d1d-1379-4e38-8faf-f6d8b78a9c3f)
